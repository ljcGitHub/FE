# 浏览器从URL输入到文档显示的过程

1.输入url地址，浏览器的进程的UI线程会捕抓到你的输入内容

2.ui线程会启动一个网络线程来获取数据

3.当网络线程获取到数据后，会通过SafeBrowsing来检查站点缩放是恶意站点。（SafeBrowsing是谷歌内部的一套站点安全系统）

4.当返回数据准备完毕，并且安全校验通过时，网络线程会通知UI线程，已经准备好了

5.UI线程会创建一个渲染器进程（Render Thread）来渲染页面

6.浏览器进程通过IPC管道将数据传递给渲染器进程，正式进入渲染流程

7.渲染器进程的核心任务是把html，css，js，image等资源渲染成用户可以交互的web页面

8.渲染器进程的主线程将html进行解析，主要是经过tokeniser标记化，通过词法分析，将html内容解析成多个标记，根据识别后的标记进行DOM树构造

9.DOM树构造过程，会创建document对象，以document为根节点的Dom树，不断进行修改，对其添加不同的元素

10.在html中，有一些图片，css，js脚本等的资源

11.加载css,图片这些资源不会阻塞html的解析，主要是因为不影响dom树的生成。但是解析script标签，会停止html解析的流程，转而加载解析和执行js（主要是浏览器不知道js执行会不会影响dom结构，例如document.write会改变dom的结构，这过程会好无意义）

12.当html解析完成之后，会生成一个Dom Tree

13.主线程需要解析css，并确定每一个dom节点的计算样式，生成样式规则

14.经过layout布局，获取节点的区域大小，坐标位置

15.主线程通过遍历dom和计算好的样式来生成layout tree（dom树和layout树不一一对应，主要是display：none，不会出现在layout tree上）

16.主线程遍历layout tree创建一个绘制记录表，该表记录绘制的顺序，这个阶段称为绘制

17.主线程将这些信息传递给合成器线程，合成器线程将每一个图层栅格化

18.合成器线程切割图层为许多图块，并传给的栅格化线程

19.栅格化线程栅格化图块，并存储在Gpu内存中

20.当图块栅格化完成后，合成器线程将收集图块的信息，信息记录图块在内存中的位置，和在页面的哪个位置绘制图块的信息

21.根据这些信息合成器线程生成一个合成器帧，将帧通过IPC传送给浏览器进程

22.浏览器进程将合成器帧传送给Gpu，GPU展示到屏幕

23.当浏览器滚动位置之后，会生成新的合成器帧，在传给GPU，在显示到屏幕